---
import Layout from '../layouts/Layout.astro';
import yaml from 'yaml';
import { readFileSync } from 'fs';

const data = yaml.parse(readFileSync('src/data/kariera.yaml', 'utf-8'));

function formatDate(dateStr: string | null): string {
  if (!dateStr) return 'současnost';
  const [year, month] = dateStr.split('-');
  const months = ['leden', 'únor', 'březen', 'duben', 'květen', 'červen', 'červenec', 'srpen', 'září', 'říjen', 'listopad', 'prosinec'];
  return `${months[parseInt(month) - 1]} ${year}`;
}
---

<Layout title="Kariéra" description="Kariéra Vojtěcha Semeckého – Senior PHP Developer & Software Architect">
  <div class="py-12">
    <h1 class="text-3xl font-bold mb-4">Kariéra</h1>

    <p class="text-gray-400 mb-10 leading-relaxed">{data.summary}</p>

    <div class="space-y-8">
      {data.experience.map((job: any) => (
        <div class="border-l-2 border-gray-700 pl-6 relative">
          <div class="absolute -left-[7px] top-1.5 w-3 h-3 rounded-full bg-gray-700"></div>
          <h2 class="text-lg font-semibold">{job.role}</h2>
          <p class="text-gray-300 font-medium">{job.company}</p>
          <p class="text-sm text-gray-500 mt-1">
            {formatDate(job.from)} – {formatDate(job.to)}
            {job.location && <span> · {job.location}</span>}
          </p>
          {job.description && (
            <p class="text-gray-400 mt-2 text-sm leading-relaxed">{job.description}</p>
          )}
          {job.technologies && (
            <p class="text-gray-500 mt-2 text-xs">{job.technologies}</p>
          )}
        </div>
      ))}
    </div>
  </div>
</Layout>
